{% macro Page(pagination, route, i, label=None, disabled=False, workspace_id=None) -%}
  {% set label = label or i %}

  {% set button_class = "page usa-button " %}

  {% if disabled %}
    {% set button_class = button_class + "usa-button-disabled" %}
  {% elif i == pagination.page %}
    {% set button_class = button_class + "usa-button-primary" %}
  {% else %}
    {% set button_class = button_class + "usa-button-secondary" %}
  {% endif %}

    <a id="{{ label }}" type="button" class="{{ button_class }}" href="{{ url_for(route, workspace_id=workspace_id, page=i, perPage=pagination.per_page) if not disabled else 'null' }}">{{ label }}</a>
{%- endmacro %}

{% macro Pagination(pagination, route, workspace_id=None) -%}
  <div class="pagination">

    {% if pagination.page == 1 %}
      {% set max_page = [pagination.pages, 5] | min %}
      {{ Page(pagination, route, 1, label="first", disabled=True, workspace_id=workspace_id) }}
      {{ Page(pagination, route, pagination.page - 1, label="prev", disabled=True, workspace_id=workspace_id) }}
      {% for i in range(1, max_page + 1) %}
        {{ Page(pagination, route, i, workspace_id=workspace_id) }}
      {% endfor %}
      {{ Page(pagination, route, pagination.page + 1, label="next", workspace_id=workspace_id) }}
      {{ Page(pagination, route, pagination.pages, label="last", workspace_id=workspace_id) }}
    {% elif pagination.page == pagination.pages %}
      {{ Page(pagination, route, 1, label="first", workspace_id=workspace_id) }}
      {{ Page(pagination, route, pagination.page - 1, label="prev", workspace_id=workspace_id) }}
      {% for i in range(pagination.pages - 4, pagination.pages + 1) %}
        {{ Page(pagination, route, i, workspace_id=workspace_id) }}
      {% endfor %}
      {{ Page(pagination, route, pagination.page + 1, label="next", disabled=True, workspace_id=workspace_id) }}
      {{ Page(pagination, route, pagination.pages, label="last", disabled=True, workspace_id=workspace_id) }}
    {% else %}
      {% set window = pagination | pageWindow %}
      {{ Page(pagination, route, 1, label="first", workspace_id=workspace_id) }}
      {{ Page(pagination, route, pagination.page - 1, label="prev", workspace_id=workspace_id) }}
      {% for i in range(window.0, window.1 + 1) %}
        {{ Page(pagination, route, i, workspace_id=workspace_id) }}
      {% endfor %}
      {{ Page(pagination, route, pagination.page + 1, label="next", workspace_id=workspace_id) }}
      {{ Page(pagination, route, pagination.pages, label="last", workspace_id=workspace_id) }}
    {% endif %}
  </div>
{%- endmacro %}
