{% from "components/icon.html" import Icon %}

<div class="application-list-item">
  <header>
    <div class="list-header">
      <div class='left'>
        <div class='h3'>{{ 'portfolios.applications.environments_heading' | translate }}</div>
      </div>
      <a class='icon-link'>
        {{ Icon('info') }}
        {{ "portfolios.admin.settings_info" | translate }}
      </a>
    </div>
  </header>

  <environments-table
    v-cloak
    v-bind:environments='{{ environments_obj }}'
    inline-template>
    <table>
      <thead>
        <th scope='col'>{{ "portfolios.applications.environments.name" | translate }}</th>
        <th scope='col' class='table-cell--align-right'>{{ "portfolios.applications.environments.members" | translate }}</th>
      </thead>

      <tbody v-for='(members_list, name) in environments' class='spend-table__portfolio'>
        <tr>
          <th scope='rowgroup' v-on:click="toggle($event, name)" v-html='name'></th>

          <template v-if="environmentsState[name].isVisible">
            <span v-on:click="toggle($event, name)" class='icon-link icon-link--large spend-table__application__toggler'>
            <td>Hide Members(<span v-html='members_list.length'></span>){{ Icon('caret_up') }}</td>
          </template>
          <template v-else>
            <span v-on:click="toggle($event, name)" class='icon-link icon-link--large spend-table__application__toggler'>
            <td>Show Members(<span v-html='members_list.length'></span>){{ Icon('caret_down') }}</td>
          </template>
        </tr>

        <tr scope='rowgroup' v-for='member in members_list' v-show='environmentsState[name].isVisible' class='spend-table__application__env'>
          <td class='accordian__item application-list-item__environment table-cell--expand'>
            <div class='application-list-item__environment__name'>
              <span v-html='member'></span>
            </div>
          </td>
        </tr>
      </tbody>

    </table>
  </environments-table>
</div>
