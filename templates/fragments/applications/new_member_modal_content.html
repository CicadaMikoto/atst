{% from "components/icon.html" import Icon %}
{% from "components/text_input.html" import TextInput %}
{% from "components/checkbox_input.html" import CheckboxInput %}
{% from "components/phone_input.html" import PhoneInput %}
{% from "fragments/applications/member_perms_form_fields.html" import MemberPermsFields %}

{% macro MemberFormTemplate(title, next_button, previous=True) %}
  <div class="modal__form--header">
    <h1>{{ Icon('avatar') }} {{ title }}</h1>
    <hr>
  </div>

  {{ caller() }}

  <div class='action-group'>
    {{ next_button }}
    {% if previous %}
      <input
          type='button'
          v-on:click="previous()"
          class='action-group__action usa-button usa-button-secondary'
          value='{{ "common.previous" | translate }}'>
    {% endif %}
    <a class='action-group__action icon-link icon-link--default' v-on:click="closeModal('{{ new_port_mem }}')">{{ "common.cancel" | translate }}</a>
  </div>
{% endmacro %}

{% macro MemberStepOne(member_form) %}
  {% set next_button %}
    <input
        type='button'
        v-on:click="next()"
        v-bind:disabled="invalid"
        class='action-group__action usa-button'
        value='{{ "portfolios.applications.members.form.next_button" | translate }}'>
  {% endset %}

  {% call MemberFormTemplate(title="portfolios.applications.members.form.add_member"|translate, next_button=next_button, previous=False) %}
    <div class='form-row'>
      {{ TextInput(member_form.user_data.first_name, validation='requiredField', optional=False) }}
    </div>
    <div class='form-row'>
      {{ TextInput(member_form.user_data.last_name, validation='requiredField', optional=False) }}
    </div>
    <div class='form-row'>
      {{ TextInput(member_form.user_data.email, validation='email', optional=False) }}
    </div>
    <div class="form-row">
      {{ PhoneInput(member_form.user_data.phone_number, member_form.user_data.phone_ext)}}
    </div>
    <div class='form-row'>
      {{ TextInput(member_form.user_data.dod_id, validation='dodId', optional=False) }}
    </div>
    <a href="#">How do I find the DoD ID?</a>
  {% endcall %}
{% endmacro %}
{% macro MemberStepTwo(member_form, application) %}
  {% set next_button %}
    <input
      type="submit"
      class='action-group__action usa-button'
      form="add-app-mem"
      value='{{ "portfolios.applications.members.form.add_member" | translate}}'>
  {% endset %}

  {% call MemberFormTemplate(title="portfolios.applications.members.form.step_2_title"|translate, next_button=next_button) %}
    {{ MemberPermsFields(app_perms_form=member_form.permission_sets, env_roles_form=member_form.environment_roles) }}
  {% endcall %}
{% endmacro %}
